<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°è³ªæ¢éšªå®¶ï¼šç¦çˆ¾æ‘©æ²™çš„è©¦ç…‰</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-up { animation: slideUp 0.4s ease-out forwards; }
        
        @keyframes bounce-custom {
            0%, 100% { transform: translateY(-5%); }
            50% { transform: translateY(0); }
        }
        .animate-bounce-custom { animation: bounce-custom 1s infinite; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        .bg-grid-pattern {
            background-image: radial-gradient(#334155 1px, transparent 1px);
            background-size: 30px 30px;
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 overflow-hidden select-none h-screen flex flex-col">

    <!-- Game Container -->
    <div id="app" class="w-full h-full flex flex-col relative">
        <!-- Content will be injected here by JavaScript -->
    </div>

    <script>
        // --- GAME DATA & CONSTANTS ---

        const CHARACTERS = [
            {
                id: 'kegui', name: 'é­”æ³•å¸«ç§‘è²´', gender: 'boy', role: 'Mage',
                desc: 'è¥¿å¯§åœ‹å°æ™ºåŠ›æ“”ç•¶ï¼Œæ“…é•·å¿«é€Ÿå¸æ”¶çŸ¥è­˜ã€‚',
                abilityName: 'åšå­¸å¤šè', abilityDesc: 'ç­”å°å•é¡Œç²å¾—çš„ç¶“é©—å€¼ +30%',
                stats: { hp: 100, xpBonus: 1.3, dmgReduction: 0, healOnHit: 0 }
            },
            {
                id: 'chongyi', name: 'é‡è »äººå´‡äº¦', gender: 'boy', role: 'Barbarian',
                desc: 'é«”è‚²èª²çš„ç‹è€…ï¼Œæ“æœ‰é©šäººçš„é«”åŠ›ã€‚',
                abilityName: 'è »è’é«”é­„', abilityDesc: 'åˆå§‹ HP é«˜é” 130',
                stats: { hp: 130, xpBonus: 1.0, dmgReduction: 0, healOnHit: 0 }
            },
            {
                id: 'peiyu', name: 'éº»æ³•å¸«å§µå¦¤', gender: 'girl', role: 'Mage',
                desc: 'å¿ƒæ€ç´°è†©ï¼Œæ‡‚å¾—å¦‚ä½•åœ¨æˆ°é¬¥ä¸­ä¿è­·è‡ªå·±ã€‚',
                abilityName: 'å…ƒç´ æ²»ç™’', abilityDesc: 'ç­”å°å•é¡Œæ™‚å›å¾© 5 é» HP',
                stats: { hp: 100, xpBonus: 1.0, dmgReduction: 0, healOnHit: 5 }
            },
            {
                id: 'yunqi', name: 'å¥³æˆ°å£«å¦˜è', gender: 'girl', role: 'Warrior',
                desc: 'äºé¦¬éœçš„å¾Œè£”ï¼Œæ“…é•·é˜²ç¦¦æ•µäººçš„æ”»æ“Šã€‚',
                abilityName: 'æˆ°é¬¥æ ¼æ“‹', abilityDesc: 'ç­”éŒ¯æ™‚å—åˆ°çš„å‚·å®³æ¸›å°‘ 5 é»',
                stats: { hp: 110, xpBonus: 1.0, dmgReduction: 5, healOnHit: 0 }
            }
        ];

        const GAME_DATA = {
            zones: [
                {
                    id: 'river', name: 'èœ¿èœ’æºªæµ', fullName: 'èœ¿èœ’æºªæµ (æ²³æµåœ°å½¢)',
                    description: 'å†’éšªçš„èµ·é»ã€‚æ°´æµæ¹æ€¥ï¼Œå……æ»¿äº†å„ç¨®å¤§å°çš„çŸ³é ­ã€‚',
                    icon: 'droplet', color: 'text-blue-500',
                    mapPos: { top: '80%', left: '20%' },
                    enemies: [
                        {
                            name: 'ä¸Šæ¸¸å·¨çŸ³æ€ª', hp: 30, dialogue: 'æˆ‘æ˜¯ä¾†è‡ªä¸Šæ¸¸çš„éœ¸ä¸»ï¼ä½ çŸ¥é“æˆ‘çš„ç‰¹å¾µå—ï¼Ÿ',
                            questions: [
                                { id: 'r1_1', q: 'æ²³æµä¸Šæ¸¸çš„æ²³åºŠé€šå¸¸å…·å‚™ä»€éº¼ç‰¹å¾µï¼Ÿ', options: ['å †æ»¿ç´°æ²™', 'å¸ƒæ»¿æœ‰ç¨œæœ‰è§’çš„å·¨çŸ³', 'å……æ»¿åœ“æ½¤çš„éµåµçŸ³', 'æ²³é“éå¸¸å¯¬é—Š'], a: 1 },
                                { id: 'r1_2', q: 'å¤ªé­¯é–£å³½è°·æ˜¯ç”±å“ªæ¢æºªæµåˆ‡å‰²å½¢æˆçš„ï¼Ÿ', options: ['æ¿æ°´æºª', 'å¤§ç”²æºª', 'ç«‹éœ§æºª', 'é«˜å±æºª'], a: 2 },
                                { id: 'r1_3', q: 'ä¸Šæ¸¸åœ°å‹¢é™¡å³­ï¼Œæµé€Ÿæ€¥ï¼Œå“ªç¨®ä½œç”¨åŠ›æœ€å¼·ï¼Ÿ', options: ['å †ç©ä½œç”¨', 'æ¬é‹ä½œç”¨', 'ä¾µè•ä½œç”¨', 'é¢¨åŒ–ä½œç”¨'], a: 2 },
                                { id: 'r1_4', q: 'ä¸Šæ¸¸æ²³è°·å¸¸è¦‹çš„åœ°å½¢æ˜¯ä»€éº¼ï¼Ÿ', options: ['Uå‹è°·', 'Vå‹è°·', 'å¯¬å»£å¹³åŸ', 'ä¸‰è§’æ´²'], a: 1 },
                                { id: 'r1_5', q: 'ç€‘å¸ƒé€šå¸¸è¼ƒå®¹æ˜“å‡ºç¾åœ¨æ²³æµçš„å“ªä¸€æ®µï¼Ÿ', options: ['ä¸Šæ¸¸', 'ä¸­æ¸¸', 'ä¸‹æ¸¸', 'å‡ºæµ·å£'], a: 0 },
                                { id: 'r1_6', q: 'æ²³æµä¸Šæ¸¸çš„å¤§çŸ³é ­ç¶“éæ¬é‹ç¢°æ’ï¼Œå½¢ç‹€æœƒè®Šå¾—å¦‚ä½•ï¼Ÿ', options: ['è®Šå¤§è®Šå°–', 'è®Šå°è®Šåœ“', 'å®Œå…¨æ¶ˆå¤±', 'è®Šæˆæ–¹å½¢'], a: 1 },
                                { id: 'r1_7', q: 'åŸºéš†æ²³ä¸Šæ¸¸å¸¸è¦‹çš„åœ“å½¢å‡¹æ´ã€Œå£ºç©´ã€ï¼Œä¸»è¦æ˜¯ä»€éº¼ä½œç”¨å½¢æˆçš„ï¼Ÿ', options: ['é¢¨åŒ–ä½œç”¨', 'æ²³æ°´å¤¾å¸¶çŸ³ç¤«æ¼©æ¸¦ä¾µè•', 'åœ°éœ‡', 'ç«å±±çˆ†ç™¼'], a: 1 },
                                { id: 'r1_8', q: 'ä¸Šæ¸¸æ²³é“é€šå¸¸æ¯”è¼ƒï¼Ÿ', options: ['å¯¬é—Š', 'ç‹¹çª„', 'å¹³å¦', 'ä¹¾ç‡¥'], a: 1 },
                                { id: 'r1_9', q: 'æˆ‘å€‘åœ¨æ²³æµä¸Šæ¸¸ï¼Œé€šå¸¸ã€Œä¸å®¹æ˜“ã€çœ‹åˆ°ä»€éº¼ï¼Ÿ', options: ['å·¨çŸ³', 'æ€¥æµ', 'å³½è°·', 'ä¸‰è§’æ´²'], a: 3 },
                                { id: 'r1_10', q: 'å¦‚æœå¡åº¦è¶Šé™¡ï¼Œæµæ°´çš„ä»€éº¼ä½œç”¨æœƒè¶Šæ˜é¡¯ï¼Ÿ', options: ['å †ç©', 'ä¾µè•èˆ‡æ¬é‹', 'è’¸ç™¼', 'å…‰åˆ'], a: 1 },
                            ]
                        },
                        {
                            name: 'ä¸­æ¸¸éµåµçŸ³ç²¾', hp: 40, dialogue: 'æˆ‘åœ¨æ»¾å‹•ä¸­è®Šå¾—åœ“æ½¤...',
                            questions: [
                                { id: 'r2_1', q: 'æ²³æµä¸­æ¸¸å¸¸è¦‹çš„çŸ³é ­å½¢ç‹€æ˜¯ï¼Ÿ', options: ['æœ‰ç¨œæœ‰è§’', 'ç´°ç²‰ç‹€', 'å…‰æ»‘åœ“æ½¤çš„éµåµçŸ³', 'å·¨å¤§çš„å²©å¡Š'], a: 2 },
                                { id: 'r2_2', q: 'çŸ³é ­åœ¨æ¬é‹éç¨‹ä¸­äº’ç›¸ç¢°æ’æ‘©æ“¦ï¼Œé«”ç©è®Šå°è®Šåœ“ï¼Œé€™å«ä»€éº¼ï¼Ÿ', options: ['ç£¨è•', 'é¢¨åŒ–', 'æº¶è§£', 'æ²‰æ¾±'], a: 0 },
                                { id: 'r2_3', q: 'æ›²æµçš„ã€Œå‡¹å²¸ã€é€šå¸¸ç™¼ç”Ÿä»€éº¼ä½œç”¨ï¼Ÿ', options: ['å †ç©ä½œç”¨', 'ä¾µè•ä½œç”¨', 'å…‰åˆä½œç”¨', 'è’¸ç™¼ä½œç”¨'], a: 1 },
                                { id: 'r2_4', q: 'æ›²æµçš„ã€Œå‡¹å²¸ã€æ°´æµé€Ÿåº¦é€šå¸¸å¦‚ä½•ï¼Ÿ', options: ['è¼ƒå¿«', 'è¼ƒæ…¢', 'éœæ­¢ä¸å‹•', 'å¿½å¿«å¿½æ…¢'], a: 0 },
                                { id: 'r2_5', q: 'æ›²æµçš„ã€Œå‡¸å²¸ã€ä¸»è¦ç™¼ç”Ÿä»€éº¼ä½œç”¨ï¼Ÿ', options: ['ä¾µè•ä½œç”¨', 'æ¬é‹ä½œç”¨', 'å †ç©ä½œç”¨', 'å´©å¡Œä½œç”¨'], a: 2 },
                                { id: 'r2_6', q: 'å¦‚æœè¦åœ¨æ²³é‚Šè“‹æˆ¿å­ï¼Œé¸åœ¨å“ªä¸€å²¸æ¯”è¼ƒå®‰å…¨ï¼ˆä¸æœƒè¢«ä¾µè•å¾Œé€€ï¼‰ï¼Ÿ', options: ['å‡¹å²¸', 'å‡¸å²¸', 'æ²³ä¸­å¤®', 'éƒ½æœƒè¢«æ·¹æ²’'], a: 1 },
                                { id: 'r2_7', q: 'å¯¦é©—è­‰æ˜ï¼Œæ°´æµé€Ÿåº¦è¶Šå¿«ï¼Œèƒ½æ¬é‹çš„çŸ³é ­ï¼Ÿ', options: ['è¶Šå°', 'è¶Šå¤§', 'è¶Šå°‘', 'ä¸€æ¨£'], a: 1 },
                                { id: 'r2_8', q: 'ç‰›è»›æ¹–é€šå¸¸æ˜¯ç”±å“ªç¨®åœ°å½¢æ¼”è®Šè€Œä¾†çš„ï¼Ÿ', options: ['ç€‘å¸ƒ', 'æ›²æµ', 'æ²™æ´²', 'å³½è°·'], a: 1 },
                                { id: 'r2_9', q: 'ç•¶æ²³æµå¾å±±å€é€²å…¥å¹³åŸï¼Œå¡åº¦è®Šç·©ï¼Œæœƒç™¼ç”Ÿä»€éº¼ç¾è±¡ï¼Ÿ', options: ['å½¢æˆæ‰‡ç‹€å †ç©(æ²–ç©æ‰‡)', 'å½¢æˆå¤§å³½è°·', 'å½¢æˆå£ºç©´', 'æ°´æµè®Šå¿«'], a: 0 },
                                { id: 'r2_10', q: 'ä¸­æ¸¸æ²³é“çš„å¯¬åº¦é€šå¸¸ä»‹æ–¼ï¼Ÿ', options: ['æœ€çª„èˆ‡æœ€å¯¬ä¹‹é–“', 'æ¯”ä¸‹æ¸¸å¯¬', 'æ¯”ä¸Šæ¸¸çª„', 'ä¸ä¸€å®š'], a: 0 },
                            ]
                        },
                        {
                            name: 'ä¸‹æ¸¸æ³¥æ²™é­”', hp: 50, dialogue: 'æˆ‘æœƒç·©æ…¢åœ°è¦†è“‹ä¸€åˆ‡...',
                            questions: [
                                { id: 'r3_1', q: 'æ²³æµä¸‹æ¸¸çš„æµé€Ÿé€šå¸¸å¦‚ä½•ï¼Ÿ', options: ['æœ€å¿«', 'ä¸­ç­‰', 'ç·©æ…¢', 'å¿½å¿«å¿½æ…¢'], a: 2 },
                                { id: 'r3_2', q: 'åœ¨æ²³æµå‡ºæµ·å£ï¼Œå¸¸è¦‹å“ªç¨®åœ°å½¢ï¼Ÿ', options: ['å³½è°·', 'ç€‘å¸ƒ', 'ä¸‰è§’æ´²', 'å£ºç©´'], a: 2 },
                                { id: 'r3_3', q: 'ä¸‹æ¸¸æ²³åºŠä¸»è¦çš„å †ç©ç‰©æ˜¯ä»€éº¼ï¼Ÿ', options: ['å·¨çŸ³', 'éµåµçŸ³', 'æ³¥æ²™', 'çŠç‘šç¤'], a: 2 },
                                { id: 'r3_4', q: 'æ²³æµä¸‹æ¸¸çš„æ²³é“å¯¬åº¦é€šå¸¸å¦‚ä½•ï¼Ÿ', options: ['æœ€çª„', 'æœ€å¯¬', 'èˆ‡ä¸Šæ¸¸ä¸€æ¨£', 'ä¸ä¸€å®š'], a: 1 },
                                { id: 'r3_5', q: 'ç‚ºä»€éº¼ä¸‹æ¸¸å®¹æ˜“ç™¼ç”Ÿæ°´ç½ï¼Ÿ', options: ['åœ°å‹¢ä½å¹³æ’æ°´æ…¢', 'çŸ³é ­å¤ªå¤š', 'æµé€Ÿå¤ªå¿«', 'æ²’æœ‰æ¤ç‰©'], a: 0 },
                                { id: 'r3_6', q: 'å°‡æ³¥æ²™æ²–åˆ·åˆ°æ›´é çš„åœ°æ–¹å †ç©ï¼Œä¸»è¦å—ä»€éº¼å› ç´ å½±éŸ¿ï¼Ÿ', options: ['çŸ³é ­é¡è‰²', 'æµé€Ÿèˆ‡å¡åº¦', 'æ°´çš„æº«åº¦', 'é­šçš„æ•¸é‡'], a: 1 },
                                { id: 'r3_7', q: 'åœ¨ã€ŒåœŸå †å¡åº¦ã€å¯¦é©—ä¸­ï¼Œç·©å¡ä»£è¡¨æ²³æµçš„å“ªä¸€æ®µï¼Ÿ', options: ['ä¸Šæ¸¸', 'ä¸­ä¸‹æ¸¸', 'ç€‘å¸ƒ', 'æºé ­'], a: 1 },
                                { id: 'r3_8', q: 'ä¸‹æ¸¸çš„å †ç©ä½œç”¨æ˜é¡¯ï¼Œæ˜¯å› ç‚ºï¼Ÿ', options: ['æµé€Ÿè®Šå¿«', 'æµé€Ÿè®Šæ…¢', 'æ°´é‡è®Šå°‘', 'æ²’æœ‰çŸ³é ­'], a: 1 },
                                { id: 'r3_9', q: 'ä¸‹åˆ—å“ªç¨®æ™¯è§€æœ€ä¸å¯èƒ½å‡ºç¾åœ¨ä¸‹æ¸¸ï¼Ÿ', options: ['å¯¬å»£çš„æ²³é¢', 'å¹³å¦çš„å¹³åŸ', 'æ·±é‚ƒçš„Vå‹è°·', 'ç´°å°çš„æ²™ç²’'], a: 2 },
                                { id: 'r3_10', q: 'ä¸‰è§’æ´²çš„å½¢æˆä¸»è¦æ˜¯å› ç‚ºå“ªç¨®ä½œç”¨ï¼Ÿ', options: ['ä¾µè•', 'æ¬é‹', 'å †ç©', 'é¢¨åŒ–'], a: 2 },
                            ]
                        }
                    ]
                },
                {
                    id: 'coast', name: 'ç‹‚é¢¨æµ·å²¸', fullName: 'ç‹‚é¢¨æµ·å²¸ (æµ·å²¸åœ°å½¢)',
                    description: 'é †æµè€Œä¸‹ï¼Œå¼·é¢¨èˆ‡æµ·æµªä¸æ–·æ‹æ‰“è‘—å²©çŸ³èˆ‡æ²™ç˜ã€‚',
                    icon: 'map', color: 'text-cyan-600',
                    mapPos: { top: '50%', left: '40%' },
                    enemies: [
                        {
                            name: 'æµ·è•å¹½éˆ', hp: 40, dialogue: 'è½è½æµ·æµªæ‹æ‰“çš„è²éŸ³...',
                            questions: [
                                { id: 'c1_1', q: 'ä¸‹åˆ—å“ªä¸€å€‹å±¬æ–¼ã€Œæµ·è•åœ°å½¢ã€ï¼Ÿ', options: ['æ²™ç˜', 'æ²™æ´²', 'æµ·è•æ‹±é–€', 'æ½Ÿæ¹–'], a: 2 },
                                { id: 'c1_2', q: 'é‡æŸ³å¥³ç‹é ­ä¸»è¦æ˜¯å—ä»€éº¼ä½œç”¨å½¢æˆçš„ï¼Ÿ', options: ['æµ·æ°´å †ç©', 'é¢¨åŒ–èˆ‡æµ·æ°´ä¾µè•', 'æ²³æµæ¬é‹', 'ç«å±±çˆ†ç™¼'], a: 1 },
                                { id: 'c1_3', q: 'åŸºéš†å’Œå¹³å³¶çš„ã€Œè±†è…å²©ã€æ˜¯æ€éº¼å½¢æˆçš„ï¼Ÿ', options: ['äººç‚ºåˆ‡å‰²', 'æµ·æ°´æ²¿è‘—å²©çŸ³ç¯€ç†ä¾µè•', 'éš•çŸ³æ’æ“Š', 'æ²³æµæ²–åˆ·'], a: 1 },
                                { id: 'c1_4', q: 'ã€Œæµ·è•æ´ã€å¦‚æœè¢«æ‰“ç©¿äº†ï¼Œæœƒè®Šæˆä»€éº¼ï¼Ÿ', options: ['æµ·è•å¹³è‡º', 'æµ·è•æº', 'æµ·è•æ‹±é–€', 'æ²™ç˜'], a: 2 },
                                { id: 'c1_5', q: 'åŒ—æµ·å²¸çš„è€æ¢…ç¶ çŸ³æ§½ï¼Œå…¶æºæ§½æ˜¯ä»€éº¼åœ°å½¢ï¼Ÿ', options: ['æµ·è•æº', 'æ–·å±¤', 'ç«å±±å£', 'æ²³æµ'], a: 0 },
                                { id: 'c1_6', q: 'å–®é¢å±±ï¼ˆå¦‚é‡æŸ³ï¼‰çš„å½¢æˆåŸå› èˆ‡ä»€éº¼æœ‰é—œï¼Ÿ', options: ['å²©å±¤è»Ÿç¡¬ä¸åŒèˆ‡å‚¾æ–œ', 'äººç‚ºå †ç–Š', 'åœ°éœ‡éš†èµ·', 'ç«å±±å™´ç™¼'], a: 0 },
                                { id: 'c1_7', q: 'æµ·è•æ‹±é–€é ‚éƒ¨å´©å¡Œå¾Œï¼Œæ®˜ç•™çš„å²©æŸ±ç¨±ç‚ºï¼Ÿ', options: ['æµ·è•æŸ±', 'æµ·è•æ´', 'æµ·è•æº', 'æ¶ˆæ³¢å¡Š'], a: 0 },
                                { id: 'c1_8', q: 'æµ·è•å¹³å°é€šå¸¸æ˜¯åœ¨ä»€éº¼æ™‚å€™éœ²å‡ºæ°´é¢ï¼Ÿ', options: ['æ¼²æ½®', 'é€€æ½®', 'é¢±é¢¨å¤©', 'æµ·å˜¯æ™‚'], a: 1 },
                                { id: 'c1_9', q: 'é‡æŸ³å¥³ç‹é ­çš„é ¸éƒ¨è¶Šä¾†è¶Šç´°ï¼Œä¸»è¦æ˜¯ä»€éº¼ä½œç”¨ï¼Ÿ', options: ['å·®ç•°ä¾µè•èˆ‡é¢¨åŒ–', 'äººç‚ºç ´å£', 'åœ°éœ‡æ–æ™ƒ', 'æ¤ç‰©ç”Ÿé•·'], a: 0 },
                                { id: 'c1_10', q: 'ä¸‹åˆ—å“ªå€‹åœ°é»ä»¥ã€Œè•ˆç‹€å²©ã€èåï¼Ÿ', options: ['é‡æŸ³', 'ä¸ƒè‚¡', 'å¢¾ä¸æ²™ç˜', 'æ¸…æ°´æ–·å´–'], a: 0 },
                            ]
                        },
                        {
                            name: 'å †ç©æ²™æ€ª', hp: 50, dialogue: 'æˆ‘é€£çµäº†å³¶å¶¼èˆ‡é™¸åœ°...',
                            questions: [
                                { id: 'c2_1', q: 'é‡‘æ¨½çš„ã€Œé™¸é€£å³¶ã€æ˜¯å› ç‚ºä»€éº¼ä½œç”¨å½¢æˆçš„ï¼Ÿ', options: ['æµ·æ°´ä¾µè•', 'æµ·æ°´å †ç©', 'åœ°æ®¼ä¸‹é™·', 'ç«å±±å™´ç™¼'], a: 1 },
                                { id: 'c2_2', q: 'ç¦éš†æµ·æ°´æµ´å ´çš„æ²™ç˜å±¬æ–¼å“ªç¨®åœ°å½¢ï¼Ÿ', options: ['æµ·è•åœ°å½¢', 'æµ·ç©åœ°å½¢', 'ç«å±±åœ°å½¢', 'å†°æ²³åœ°å½¢'], a: 1 },
                                { id: 'c2_3', q: 'è‡ºå—ä¸ƒè‚¡çš„ã€Œæ–°æµ®å´™æ±•ã€æ˜¯ä»€éº¼ï¼Ÿ', options: ['æµ·è•æ´', 'é›¢å²¸æ²™æ´²', 'æµ·è•å¹³è‡º', 'æµ·è•æº'], a: 1 },
                                { id: 'c2_4', q: 'æ²™æ´²é€šå¸¸æ˜¯ç”±ä»€éº¼ç‰©è³ªå †ç©è€Œæˆï¼Ÿ', options: ['å·¨å¤§çš„å²©çŸ³', 'æ³¥æ²™', 'çŠç‘šç¤', 'è²æ®¼'], a: 1 },
                                { id: 'c2_5', q: 'æ½Ÿæ¹–ï¼ˆå¦‚ä¸ƒè‚¡æ½Ÿæ¹–ï¼‰é€šå¸¸ä½æ–¼ä»€éº¼çš„å…§å´ï¼Ÿ', options: ['æ²™æ´²', 'æ‡¸å´–', 'æ·±æµ·', 'é«˜å±±'], a: 0 },
                                { id: 'c2_6', q: 'æµ·ç©åœ°å½¢çš„ä¸»è¦å‹•åŠ›ä¾†æºæ˜¯ä»€éº¼ï¼Ÿ', options: ['é¢¨èˆ‡æµ·æµª', 'åœ°éœ‡', 'ç«å±±', 'åœ°å¿ƒå¼•åŠ›'], a: 0 },
                                { id: 'c2_7', q: 'æ¡ƒåœ’çš„ã€Œè‰æ¼¯æ²™ä¸˜ã€ä¸»è¦æ˜¯ç”±ä»€éº¼åŠ›é‡æ¬é‹å †ç©çš„ï¼Ÿ', options: ['å¼·å‹çš„é¢¨', 'æ²³æµ', 'å†°å·', 'å‹•ç‰©'], a: 0 },
                                { id: 'c2_8', q: 'ä¸‹åˆ—ä½•è€…ä¸æ˜¯æµ·ç©åœ°å½¢ï¼Ÿ', options: ['æ²™ç˜', 'æ²™å˜´', 'æµ·è•å´–', 'é›¢å²¸æ²™æ´²'], a: 2 },
                                { id: 'c2_9', q: 'é™¸é€£å³¶æ˜¯é€£æ¥äº†ä»€éº¼èˆ‡é™¸åœ°ï¼Ÿ', options: ['é›¢å²¸å°å³¶', 'å¦ä¸€å¡Šå¤§é™¸', 'èˆ¹éš»', 'ç‡ˆå¡”'], a: 0 },
                                { id: 'c2_10', q: 'æƒ³è¦å»æµ·é‚Šç©æ²™å †åŸå ¡ï¼Œæ‡‰è©²å»å“ªè£¡ï¼Ÿ', options: ['èŠ±è“®å¤ªé­¯é–£', 'é‡æŸ³åœ°è³ªå…¬åœ’', 'ç¦éš†æµ·æ°´æµ´å ´', 'å’Œå¹³å³¶'], a: 2 },
                            ]
                        }
                    ]
                },
                {
                    id: 'rocks', name: 'ç¤¦ç‰©ç‹åœ‹', fullName: 'ç¤¦ç‰©ç‹åœ‹ (å²©çŸ³èˆ‡ç¤¦ç‰©)',
                    description: 'æ·±å…¥åœ°åº•ï¼Œé€™è£¡é–ƒè€€è‘—å¥‡ç•°çš„å…‰èŠ’ã€‚',
                    icon: 'hammer', color: 'text-gray-700',
                    mapPos: { top: '60%', left: '70%' },
                    enemies: [
                        {
                            name: 'ç¤¦ç‰©é‘‘è­˜å®˜', hp: 45, dialogue: 'åªæœ‰æœ€ç¡¬çš„ç¤¦ç‰©æ‰èƒ½é€šéï¼',
                            questions: [
                                { id: 'ro1_1', q: 'ä¸‹åˆ—å“ªç¨®ç¤¦ç‰©çš„ç¡¬åº¦æœ€å°ï¼ˆæœ€è»Ÿï¼‰ï¼Ÿ', options: ['çŸ³è‹±', 'æ–¹è§£çŸ³', 'æ»‘çŸ³', 'é‡‘å‰›çŸ³'], a: 2 },
                                { id: 'ro1_2', q: 'æˆ‘å€‘å¯ä»¥ç”¨ä»€éº¼ç°¡å–®çš„æ–¹æ³•æ¸¬è©¦ç¤¦ç‰©ç¡¬åº¦ï¼Ÿ', options: ['ç”¨ç«ç‡’', 'äº’ç›¸åˆ»åŠƒ', 'æ³¡æ°´', 'è½è²éŸ³'], a: 1 },
                                { id: 'ro1_3', q: 'çŸ³ç°å²©çš„ä¸»è¦æˆåˆ†æ˜¯ä»€éº¼ç¤¦ç‰©ï¼Ÿ', options: ['é•·çŸ³', 'çŸ³è‹±', 'æ–¹è§£çŸ³', 'é»‘é›²æ¯'], a: 2 },
                                { id: 'ro1_4', q: 'æ»´ç¨€é¹½é…¸æœƒç”¢ç”Ÿæ°£æ³¡çš„æ˜¯å“ªç¨®ç¤¦ç‰©ï¼Ÿ', options: ['çŸ³è‹±', 'æ–¹è§£çŸ³', 'ç¡«ç£º', 'æ»‘çŸ³'], a: 1 },
                                { id: 'ro1_5', q: 'æŒ‡ç”²å¯ä»¥åˆ®å‡ºç—•è·¡ï¼Œä»£è¡¨è©²ç¤¦ç‰©ç¡¬åº¦æ¯”æŒ‡ç”²ï¼Ÿ', options: ['å¤§', 'å°', 'ä¸€æ¨£', 'ç„¡æ³•æ¯”è¼ƒ'], a: 1 },
                                { id: 'ro1_6', q: 'å¸¸è¢«ç”¨ä¾†åšæˆçˆ½èº«ç²‰çš„æ˜¯å“ªç¨®ç¤¦ç‰©ï¼Ÿ', options: ['çŸ³å¢¨', 'ç¡«ç£º', 'æ»‘çŸ³', 'çŸ³è†'], a: 2 },
                                { id: 'ro1_7', q: 'å…·æœ‰ç‰¹æ®Šæ°£å‘³ï¼Œå¯ç”¨ä¾†è£½ä½œç«è—¥çš„æ˜¯ï¼Ÿ', options: ['ç¡«ç£º', 'çŸ³è‹±', 'é›²æ¯', 'é•·çŸ³'], a: 0 },
                                { id: 'ro1_8', q: 'ç¤¦ç‰©æ¢ç—•çš„é¡è‰²æ˜¯æŒ‡ç¤¦ç‰©ä»€éº¼ç‹€æ…‹ä¸‹çš„é¡è‰²ï¼Ÿ', options: ['ç²‰æœ«', 'çµæ™¶', 'ç‡ƒç‡’', 'æº¶åŒ–'], a: 0 },
                                { id: 'ro1_9', q: 'çŸ³è‹±å¸¸è¢«ç”¨ä¾†è£½ä½œä»€éº¼ï¼Ÿ', options: ['ç»ç’ƒèˆ‡é£¾å“', 'æ°´æ³¥', 'é‰›ç­†èŠ¯', 'çˆ½èº«ç²‰'], a: 0 },
                                { id: 'ro1_10', q: 'é›²æ¯çš„ç‰¹æ€§æ˜¯å¯ä»¥å‰æˆï¼Ÿ', options: ['è–„ç‰‡ç‹€', 'ç²‰æœ«ç‹€', 'çƒç‹€', 'æ¶²é«”ç‹€'], a: 0 },
                                { id: 'ro1_11', q: 'å¦‚æœåœ¨é‡å¤–æ’¿åˆ°ä¸€å¡ŠçŸ³é ­ï¼Œæƒ³åˆ†è¾¨æ˜¯å¦ç‚ºçŸ³ç°å²©ï¼Œå¯ä»¥æ»´ï¼Ÿ', options: ['æ°´', 'ç¨€é¹½é…¸', 'é†¬æ²¹', 'æ²™æ‹‰æ²¹'], a: 1 },
                                { id: 'ro1_12', q: 'ä¸‹åˆ—å“ªç¨®ç¤¦ç‰©ç¡¬åº¦æœ€é«˜ï¼Ÿ', options: ['æ»‘çŸ³', 'çŸ³è†', 'æ–¹è§£çŸ³', 'çŸ³è‹±'], a: 3 },
                            ]
                        },
                        {
                            name: 'å²©çŸ³å·¨äºº', hp: 60, dialogue: 'æˆ‘æ˜¯ç”±é«˜æº«èˆ‡é«˜å£“é›é€ è€Œæˆçš„ï¼',
                            questions: [
                                { id: 'ro2_1', q: 'èŠ±å´—å²©ä¸»è¦ç”±é•·çŸ³ã€çŸ³è‹±å’Œä»€éº¼çµ„æˆï¼Ÿ', options: ['æ»‘çŸ³', 'ç¡«ç£º', 'é»‘é›²æ¯', 'çŸ³è†'], a: 2 },
                                { id: 'ro2_2', q: 'å“ªç¨®å²©çŸ³æ˜¯ç”¨ä¾†è£½é€ æ°´æ³¥çš„ä¸»è¦åŸæ–™ï¼Ÿ', options: ['å®‰å±±å²©', 'èŠ±å´—å²©', 'çŸ³ç°å²©', 'ç„æ­¦å²©'], a: 2 },
                                { id: 'ro2_3', q: 'é‰›ç­†ç­†èŠ¯æ˜¯ç”±ä»€éº¼è£½æˆçš„ï¼Ÿ', options: ['çŸ³å¢¨+é»åœŸ', 'ç…¤ç‚­', 'é»‘æ›œçŸ³', 'é‰›'], a: 0 },
                                { id: 'ro2_4', q: 'å¤§ç†å²©æ˜¯ç”±ä»€éº¼å²©çŸ³è®Šè³ªè€Œæˆçš„ï¼Ÿ', options: ['é å²©', 'çŸ³ç°å²©', 'èŠ±å´—å²©', 'ç ‚å²©'], a: 1 },
                                { id: 'ro2_5', q: 'å®‰å±±å²©å¸¸è¦‹æ–¼å“ªç¨®åœ°å½¢ï¼Ÿ', options: ['ç«å±±åœ°å½¢', 'æ²™æ¼ åœ°å½¢', 'å†°æ²³åœ°å½¢', 'å¹³åŸåœ°å½¢'], a: 0 },
                                { id: 'ro2_6', q: 'æ¾æ¹–è‘—åçš„æŸ±ç‹€ç„æ­¦å²©å±¬æ–¼å“ªä¸€é¡å²©çŸ³ï¼Ÿ', options: ['æ²‰ç©å²©', 'ç«æˆå²©', 'è®Šè³ªå²©', 'åŒ–çŸ³'], a: 1 },
                                { id: 'ro2_7', q: 'å“ªç¨®å²©çŸ³å¸¸ç”¨ä¾†åšå»Ÿå®‡çš„é¾æŸ±æˆ–çŸ³ç…ï¼Ÿ', options: ['é å²©', 'å®‰å±±å²©', 'çŸ³ç°å²©', 'æ¿å²©'], a: 1 },
                                { id: 'ro2_8', q: 'é å²©ç¶“éé«˜æº«é«˜å£“è®Šè³ªå¾Œï¼Œæœƒå½¢æˆï¼Ÿ', options: ['æ¿å²©', 'å¤§ç†å²©', 'èŠ±å´—å²©', 'ç„æ­¦å²©'], a: 0 },
                                { id: 'ro2_9', q: 'æ²‰ç©å²©é€šå¸¸å…·æœ‰ä»€éº¼æ§‹é€ ï¼Ÿ', options: ['å±¤ç†', 'æ°£å­”', 'ç‰‡ç‹€', 'æŸ±ç‹€'], a: 0 },
                                { id: 'ro2_10', q: 'ä¸‹åˆ—ä½•è€…å±¬æ–¼ç«æˆå²©ï¼Ÿ', options: ['çŸ³ç°å²©', 'ç ‚å²©', 'èŠ±å´—å²©', 'å¤§ç†å²©'], a: 2 },
                                { id: 'ro2_11', q: 'å“ªç¨®å²©çŸ³è¡¨é¢å¸¸æœ‰æ°£å­”ï¼ˆå› ç‚ºå²©æ¼¿å†·å»æ°£é«”é€¸å‡ºï¼‰ï¼Ÿ', options: ['èŠ±å´—å²©', 'ç„æ­¦å²©', 'å¤§ç†å²©', 'çŸ³ç°å²©'], a: 1 },
                                { id: 'ro2_12', q: 'åŒ–çŸ³æœ€å®¹æ˜“åœ¨å“ªç¨®å²©çŸ³ä¸­ç™¼ç¾ï¼Ÿ', options: ['æ²‰ç©å²©', 'ç«æˆå²©', 'è®Šè³ªå²©', 'éš•çŸ³'], a: 0 },
                                { id: 'ro2_13', q: 'å²©çŸ³é¢¨åŒ–å¾Œï¼Œæœ€çµ‚æœƒè®Šæˆï¼Ÿ', options: ['åœŸå£¤', 'åŒ–çŸ³', 'å¯¶çŸ³', 'é‡‘å±¬'], a: 0 },
                            ]
                        }
                    ]
                },
                {
                    id: 'disaster', name: 'éœ‡å‹•å±±è„ˆ', fullName: 'éœ‡å‹•å±±è„ˆ (å¤©ç„¶ç½å®³)',
                    description: 'æœ€çµ‚è©¦ç…‰ã€‚å¤§åœ°åœ¨é¡«æŠ–ï¼Œå°å¿ƒè½çŸ³ï¼',
                    icon: 'alert-triangle', color: 'text-red-600',
                    mapPos: { top: '20%', left: '85%' },
                    enemies: [
                        {
                            name: 'éœ‡æ³¢é¾', hp: 80, dialogue: 'ä½ æ„Ÿå—éå¤§åœ°çš„æ†¤æ€’å—ï¼Ÿ',
                            questions: [
                                { id: 'd1_1', q: 'åœ°éœ‡ç™¼ç”Ÿæ™‚ï¼Œä¿è­·è‡ªå·±çš„å£è¨£æ˜¯ï¼Ÿ', options: ['å¿«è·‘ã€å°–å«ã€å¤§å“­', 'è¶´ä¸‹ã€æ©è­·ã€ç©©ä½', 'æ‰“å¡ã€æ‹ç…§ã€ä¸Šå‚³', 'æ­é›»æ¢¯ã€è·³æ¨“ã€é–‰çœ¼'], a: 1 },
                                { id: 'd1_2', q: 'åœ°éœ‡å ±å‘Šä¸­ï¼Œä»£è¡¨ã€Œåœ°éœ‡é‡‹æ”¾èƒ½é‡å¤§å°ã€çš„æ˜¯ï¼Ÿ', options: ['éœ‡åº¦', 'éœ‡æº', 'èŠ®æ°è¦æ¨¡', 'éœ‡å¤®'], a: 2 },
                                { id: 'd1_3', q: 'ç·Šæ€¥é¿é›£åŒ…å…§ã€Œä¸éœ€è¦ã€æ”¾ä»€éº¼ï¼Ÿ', options: ['ä¹¾ç³§èˆ‡æ°´', 'æ‰‹é›»ç­’', 'é›»å‹•ç©å…·', 'å“¨å­'], a: 2 },
                                { id: 'd1_4', q: 'éœ‡æºå‚ç›´å‘ä¸Šèˆ‡åœ°è¡¨çš„äº¤é»ç¨±ç‚ºï¼Ÿ', options: ['éœ‡å¤®', 'æ–·å±¤', 'éœ‡åº¦', 'åœ°éœ‡å¸¶'], a: 0 },
                                { id: 'd1_5', q: 'åœ°éœ‡æ™‚ï¼Œç‚ºä»€éº¼ä¸èƒ½æ­é›»æ¢¯ï¼Ÿ', options: ['é›»æ¢¯æœƒæšˆ', 'å¯èƒ½åœé›»å—å›°', 'é›»æ¢¯å¤ªæ…¢', 'æ€•é‡åˆ°é„°å±…'], a: 1 },
                                { id: 'd1_6', q: 'ã€Œéœ‡åº¦ã€æ˜¯ç”¨ä¾†è¡¨ç¤ºä»€éº¼ï¼Ÿ', options: ['åœ°éœ‡é‡‹æ”¾çš„èƒ½é‡', 'åœ°è¡¨æ–æ™ƒçš„ç¨‹åº¦', 'åœ°éœ‡ç™¼ç”Ÿçš„æ·±åº¦', 'æ–·å±¤çš„é•·åº¦'], a: 1 },
                                { id: 'd1_7', q: 'ä¸‹åˆ—ä½•è€…ä¸æ˜¯åœ°éœ‡å¯èƒ½å¼•ç™¼çš„ç½å®³ï¼Ÿ', options: ['æµ·å˜¯', 'å±±å´©', 'åœŸå£¤æ¶²åŒ–', 'é¢±é¢¨'], a: 3 },
                                { id: 'd1_8', q: 'åœ°éœ‡å ±å‘Šä¸­çš„ã€Œå„åœ°æœ€å¤§éœ‡åº¦ã€ï¼ŒåŒä¸€å ´åœ°éœ‡å„åœ°æœƒï¼Ÿ', options: ['éƒ½ä¸€æ¨£', 'ä¸ä¸€æ¨£', 'éƒ½æ˜¯ 0', 'éƒ½æ˜¯ 7'], a: 1 },
                                { id: 'd1_9', q: 'å¹³æ™‚æ‡‰è©²å›ºå®šå¥½å®¶å…·ï¼Œæ˜¯ç‚ºäº†é é˜²ï¼Ÿ', options: ['å°å·', 'åœ°éœ‡æ–æ™ƒå‚¾å€’', 'é¢¨å¹èµ°', 'ç™¼éœ‰'], a: 1 },
                                { id: 'd1_10', q: 'èŠ®æ°è¦æ¨¡ 6.0 å’Œ 4.0 çš„åœ°éœ‡ï¼Œå“ªä¸€å€‹é‡‹æ”¾èƒ½é‡è¼ƒå¤§ï¼Ÿ', options: ['6.0', '4.0', 'ä¸€æ¨£å¤§', 'ç„¡æ³•æ¯”è¼ƒ'], a: 0 },
                                { id: 'd1_11', q: 'åœ°éœ‡ç™¼ç”Ÿæ™‚åœ¨å®¤å…§ï¼Œæ‡‰è©²å„ªå…ˆèº²åœ¨å“ªè£¡ï¼Ÿ', options: ['å …å›ºæ¡Œå­ä¸‹', 'çª—æˆ¶æ—', 'é™½å°', 'è¡£æ«ƒè£¡'], a: 0 },
                                { id: 'd1_12', q: 'ã€Œå®¶åº­é˜²ç½å¡ã€çš„ä¸»è¦ç”¨é€”æ˜¯ï¼Ÿ', options: ['ç´€éŒ„é›¶ç”¨éŒ¢', 'ç´„å®šç½å¾Œé›†åˆåœ°é»èˆ‡è¯çµ¡æ–¹å¼', 'ç´€éŒ„è€ƒè©¦æˆç¸¾', 'æ”¶é›†è²¼ç´™'], a: 1 },
                                { id: 'd1_13', q: 'é«˜é›„æœˆä¸–ç•Œçš„ã€Œæƒ¡åœ°ã€åœ°å½¢ï¼Œä¸»è¦æ˜¯å“ªç¨®å²©çŸ³æ§‹æˆï¼Ÿ', options: ['æ³¥å²©', 'èŠ±å´—å²©', 'ç„æ­¦å²©', 'å¤§ç†å²©'], a: 0 },
                                { id: 'd1_14', q: 'åœ°éœ‡æ·±åº¦è¶Šæ·ºï¼Œé€šå¸¸å°åœ°è¡¨çš„ç ´å£åŠ›ï¼Ÿ', options: ['è¶Šå°', 'è¶Šå¤§', 'æ²’å½±éŸ¿', 'è®Šæˆé¾æ²é¢¨'], a: 1 },
                                { id: 'd1_15', q: 'æµ·å˜¯é€šå¸¸æ˜¯ç”±ä»€éº¼åŸå› å¼•ç™¼çš„ï¼Ÿ', options: ['æµ·åº•åœ°éœ‡æˆ–ç«å±±çˆ†ç™¼', 'å¼·é¢¨', 'å¤§é›¨', 'æ½®æ±'], a: 0 },
                                { id: 'd1_16', q: 'åœ°éœ‡å ±å‘Šä¸­ï¼Œéœ‡åº¦æ•¸å­—è¶Šå¤§ä»£è¡¨ï¼Ÿ', options: ['æ–æ™ƒè¶ŠåŠ‡çƒˆ', 'æ–æ™ƒè¶Šè¼•å¾®', 'åœ°éœ‡è¶Šæ·±', 'åœ°éœ‡è¶Šä¹…'], a: 0 },
                                { id: 'd1_17', q: 'ä¸‹åˆ—å“ªç¨®è¡Œç‚ºåœ¨åœ°éœ‡æ™‚æ˜¯ã€ŒéŒ¯èª¤ã€çš„ï¼Ÿ', options: ['é—œé–‰ç«æº', 'æ‰“é–‹å¤§é–€', 'æ­é›»æ¢¯é€ƒç”Ÿ', 'ä¿è­·é ­éƒ¨'], a: 2 },
                                { id: 'd1_18', q: 'åœ°è³ªå…¬åœ’ï¼ˆå¦‚é‡æŸ³ã€ç‡•å·¢ï¼‰è¨­ç«‹çš„ä¸»è¦ç›®çš„æ˜¯ï¼Ÿ', options: ['è“‹éŠæ¨‚åœ’', 'ä¿è­·ç‰¹æ®Šåœ°è³ªæ™¯è§€', 'é–‹æ¡ç¤¦çŸ³', 'è“‹å¤§æ¨“'], a: 1 },
                            ]
                        }
                    ]
                }
            ]
        };

        // --- GLOBAL STATE ---
        let gameState = 'START'; // START, CHAR_SELECT, MAP, BATTLE, VICTORY, GAMEOVER
        let player = {
            name: '', role: '', hp: 100, maxHp: 100, level: 1, xp: 0, maxXp: 50,
            items: [], completedZones: [], characterId: null, stats: {}, solvedQuestionIds: []
        };
        let currentZone = null;
        let currentEnemy = null;
        let currentQuestion = null;
        let battleLog = [];
        let enemyIndex = 0;
        let showZoneInfo = null;
        let questionCountInBattle = 0;

        // --- HELPER FUNCTIONS ---
        
        function addLog(text) {
            battleLog.push(text);
            if (battleLog.length > 4) battleLog.shift();
            renderApp(); // Re-render to show log
        }

        function unlockZone(zoneId) {
            const index = GAME_DATA.zones.findIndex(z => z.id === zoneId);
            if (index === 0) return true;
            const prevZoneId = GAME_DATA.zones[index - 1].id;
            return player.completedZones.includes(prevZoneId);
        }

        function getUnsolvedQuestion(enemy) {
            const availableQuestions = enemy.questions.filter(q => !player.solvedQuestionIds.includes(q.id));
            if (availableQuestions.length === 0) return null;
            const randomIndex = Math.floor(Math.random() * availableQuestions.length);
            return availableQuestions[randomIndex];
        }

        // --- GAME ACTIONS ---

        function toCharSelect() {
            gameState = 'CHAR_SELECT';
            renderApp();
        }

        function selectCharacter(charId) {
            const char = CHARACTERS.find(c => c.id === charId);
            player = {
                name: char.name, role: char.role, hp: char.stats.hp, maxHp: char.stats.hp,
                level: 1, xp: 0, maxXp: 50, items: [], completedZones: [],
                characterId: char.id, stats: char.stats, solvedQuestionIds: []
            };
            gameState = 'MAP';
            battleLog = [`æ­¡è¿ ${char.name} ä¾†åˆ°åœ°è³ªä¸–ç•Œï¼`, `ç‰¹æ®Šèƒ½åŠ›ï¼š${char.abilityName} å·²å•Ÿç”¨ï¼`];
            renderApp();
        }

        function showZonePopup(zoneId) {
            const zone = GAME_DATA.zones.find(z => z.id === zoneId);
            if (unlockZone(zone.id)) {
                showZoneInfo = zone;
                renderApp();
            }
        }

        function closeZonePopup() {
            showZoneInfo = null;
            renderApp();
        }

        function enterZone(zoneId) {
            const zone = GAME_DATA.zones.find(z => z.id === zoneId);
            if (!unlockZone(zone.id)) return;
            currentZone = zone;
            enemyIndex = 0;
            showZoneInfo = null;
            startBattle(zone.enemies[0]);
        }

        function startBattle(enemy) {
            const startQ = getUnsolvedQuestion(enemy);
            
            if (!startQ) {
                // Auto-win/skip logic if no questions
                battleLog.push(`ğŸ‰ ${enemy.name} çš„è©¦ç…‰å·²å…¨éƒ¨å®Œæˆï¼`);
                handleEnemyDefeat(enemy);
                return;
            }

            currentEnemy = { ...enemy, currentHp: enemy.hp };
            currentQuestion = startQ;
            questionCountInBattle = 0;
            gameState = 'BATTLE';
            battleLog.push(`é­é‡æ•µäººï¼š${enemy.name}ï¼`);
            battleLog.push(enemy.dialogue);
            // Limit log to 4
            if(battleLog.length > 4) battleLog = battleLog.slice(battleLog.length - 4);
            renderApp();
        }

        function handleAnswer(optionIndex) {
            if (!currentQuestion) return;
            const isCorrect = optionIndex === currentQuestion.a;

            if (isCorrect) {
                // Damage Enemy
                const damageDealt = 15;
                currentEnemy.currentHp -= damageDealt;
                addLog(`âœ… å›ç­”æ­£ç¢ºï¼å° ${currentEnemy.name} é€ æˆå‚·å®³ï¼`);

                // Update Solved
                if(!player.solvedQuestionIds.includes(currentQuestion.id)) {
                    player.solvedQuestionIds.push(currentQuestion.id);
                }

                // Player Heal (Ability)
                if (player.stats.healOnHit > 0 && player.hp < player.maxHp) {
                    const heal = Math.min(player.maxHp - player.hp, player.stats.healOnHit);
                    player.hp += heal;
                    addLog(`âœ¨ ${player.stats.healOnHit} é» HP å›å¾©ï¼`);
                }

                // XP Gain
                const xpBase = 15;
                const xpGain = Math.floor(xpBase * player.stats.xpBonus);
                player.xp += xpGain;
                if (player.stats.xpBonus > 1.0) addLog(`ğŸ“š ç²å¾— ${xpGain} XP (åŠ æˆ)ï¼`);

                // Level Up
                if (player.xp >= player.maxXp) {
                    player.xp -= player.maxXp;
                    player.level++;
                    player.maxXp = Math.floor(player.maxXp * 1.5);
                    player.hp = player.maxHp;
                    addLog(`ğŸ‰ å‡ç´šäº†ï¼ç­‰ç´š ${player.level}ï¼HP å…¨æ»¿ï¼`);
                }

                // Check Win
                if (currentEnemy.currentHp <= 0) {
                    handleEnemyDefeat(currentEnemy);
                } else {
                    // Next Question
                    const nextQ = getUnsolvedQuestion(GAME_DATA.zones.find(z => z.id === currentZone.id).enemies[enemyIndex]);
                    if (nextQ) {
                        setTimeout(() => {
                            currentQuestion = nextQ;
                            questionCountInBattle++;
                            renderApp();
                        }, 1000);
                    } else {
                        addLog(`ğŸ“ ${currentEnemy.name} å·²ç„¡æ›´å¤šå•é¡Œï¼`);
                        setTimeout(() => handleEnemyDefeat(currentEnemy), 1000);
                    }
                }
            } else {
                // Wrong Answer
                const baseDmg = 15;
                const dmg = Math.max(1, baseDmg - player.stats.dmgReduction);
                player.hp -= dmg;
                addLog(`âŒ éŒ¯èª¤ï¼å—å‚· ${dmg} é»ã€‚`);
                if (player.stats.dmgReduction > 0) addLog(`ğŸ›¡ï¸ å‚·å®³æ¸›å°‘äº† ${player.stats.dmgReduction}ï¼`);
                addLog(`æ­£è§£ï¼š${currentQuestion.options[currentQuestion.a]}`);
                
                if (player.hp <= 0) {
                    setTimeout(() => {
                        gameState = 'GAMEOVER';
                        renderApp();
                    }, 1000);
                } else {
                    renderApp();
                }
            }
            renderApp();
        }

        function handleEnemyDefeat(enemy) {
            addLog(`ğŸ† æ“Šæ•—äº† ${enemy.name}ï¼`);
            renderApp();

            if (enemyIndex + 1 >= currentZone.enemies.length) {
                // Zone Clear
                handleZoneClear();
            } else {
                // Next Enemy
                setTimeout(() => {
                    enemyIndex++;
                    startBattle(currentZone.enemies[enemyIndex]);
                }, 1500);
            }
        }

        function handleZoneClear() {
            let item = '';
            switch(currentZone.id) {
                case 'river': item = 'éµåµçŸ³å¾½ç« '; break;
                case 'coast': item = 'å¥³ç‹é ­æ¨¡å‹'; break;
                case 'rocks': item = 'æ°´æ™¶åŸç¤¦'; break;
                case 'disaster': item = 'é˜²ç½é”äººè­‰æ›¸'; break;
                default: item = 'æœªçŸ¥å¯¶ç‰©';
            }

            if (!player.items.includes(item)) {
                player.items.push(item);
                addLog(`ğŸ ç²å¾—ï¼š${item}ï¼`);
            }
            if (!player.completedZones.includes(currentZone.id)) {
                player.completedZones.push(currentZone.id);
            }

            gameState = 'VICTORY';
            renderApp();
        }

        function returnToMap() {
            gameState = 'MAP';
            showZoneInfo = null;
            renderApp();
        }

        function restartGame() {
            gameState = 'START';
            player = {
                name: '', role: '', hp: 100, maxHp: 100, level: 1, xp: 0, maxXp: 50,
                items: [], completedZones: [], characterId: null, stats: {}, solvedQuestionIds: []
            };
            battleLog = [];
            renderApp();
        }

        // --- RENDER FUNCTIONS (HTML Generation) ---

        function renderApp() {
            const app = document.getElementById('app');
            let content = '';

            // Common Header (Except Start/CharSelect)
            if (gameState !== 'START' && gameState !== 'CHAR_SELECT') {
                content += `
                <header class="bg-slate-900 border-b border-slate-800 p-3 flex justify-between items-center shadow-lg z-20">
                    <div class="flex items-center gap-2">
                        <i data-lucide="mountain" class="text-amber-500 w-6 h-6"></i>
                        <span class="font-bold text-amber-100 hidden md:block">åœ°è³ªæ¢éšªå®¶</span>
                    </div>
                    <button onclick="returnToMap()" class="px-3 py-1 text-xs bg-slate-700 hover:bg-slate-600 text-slate-100 border-b-4 border-slate-900 rounded font-bold transition-all active:scale-95">
                        è¿”å›åœ°åœ–
                    </button>
                </header>`;
            }

            content += `<main class="flex-1 overflow-auto bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-black relative w-full h-full">`;

            switch (gameState) {
                case 'START':
                    content += renderStart();
                    break;
                case 'CHAR_SELECT':
                    content += renderCharSelect();
                    break;
                case 'MAP':
                    content += renderMap();
                    break;
                case 'BATTLE':
                    content += renderBattle();
                    break;
                case 'VICTORY':
                    content += renderVictory();
                    break;
                case 'GAMEOVER':
                    content += renderGameOver();
                    break;
            }

            content += `</main>`;
            app.innerHTML = content;
            
            // Re-initialize Icons
            lucide.createIcons();

            // Scroll Battle Log
            const logEl = document.getElementById('battle-log-container');
            if (logEl) logEl.scrollTop = logEl.scrollHeight;
        }

        function renderStart() {
            return `
            <div class="flex flex-col items-center justify-center h-full text-center space-y-6 p-6 relative animate-fade-in">
                <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80')] bg-cover bg-center opacity-20 pointer-events-none"></div>
                <div class="bg-slate-900/90 p-8 rounded-2xl border-4 border-amber-600 shadow-2xl max-w-md w-full z-10 backdrop-blur-sm">
                    <h1 class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-yellow-200 mb-4 drop-shadow-sm">åœ°è³ªæ¢éšªå®¶</h1>
                    <h2 class="text-xl text-amber-200 mb-8 font-serif tracking-widest">è¥¿å¯§åœ‹å°å…­å¹´ç´šç¯‡</h2>
                    <div class="space-y-4 text-slate-300 mb-8 text-sm md:text-base">
                        <p>è¥¿å¯§åœ‹å°çš„åŒå­¸å€‘ï¼Œæº–å‚™å¥½è¿æ¥æŒ‘æˆ°äº†å—ï¼Ÿ</p>
                        <p>é¸æ“‡ä½ çš„è§’è‰²ï¼Œé‹ç”¨èª²å ‚æ‰€å­¸çš„çŸ¥è­˜ï¼Œ</p>
                        <p>é€šéæ²³æµã€æµ·å²¸ã€ç¤¦è„ˆèˆ‡éœ‡ç½çš„å››å¤§è©¦ç…‰ï¼</p>
                    </div>
                    <button onclick="toCharSelect()" class="w-full py-4 text-lg bg-amber-600 hover:bg-amber-500 text-white border-b-4 border-amber-800 rounded-lg font-bold shadow-md transition-all active:scale-95 animate-pulse">é–‹å§‹é¸æ“‡è§’è‰²</button>
                </div>
            </div>`;
        }

        function renderCharSelect() {
            let html = `
            <div class="flex flex-col items-center justify-center min-h-full p-6 bg-slate-900 animate-fade-in">
                <h2 class="text-3xl font-bold text-amber-400 mb-2">é¸æ“‡ä½ çš„è§’è‰²</h2>
                <p class="text-slate-400 mb-8">æ¯å€‹è§’è‰²éƒ½æœ‰ç¨ç‰¹çš„å„ªå‹¢ï¼Œè«‹è¬¹æ…é¸æ“‡ï¼</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl w-full">`;
            
            CHARACTERS.forEach(char => {
                const iconColor = char.gender === 'boy' ? 'text-blue-300 bg-blue-900' : 'text-pink-300 bg-pink-900';
                html += `
                <button onclick="selectCharacter('${char.id}')" class="flex flex-col text-left bg-slate-800 hover:bg-slate-700 border-2 border-slate-600 hover:border-amber-500 rounded-xl p-4 transition-all group active:scale-95">
                    <div class="flex items-center gap-4 mb-3 border-b border-slate-700 pb-3 w-full">
                        <div class="p-3 rounded-full ${iconColor}">
                            <i data-lucide="user" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white group-hover:text-amber-400">${char.name}</h3>
                            <span class="text-xs px-2 py-0.5 rounded bg-slate-900 text-slate-400">${char.role}</span>
                        </div>
                    </div>
                    <div class="flex-1 space-y-2 mb-4 w-full">
                        <p class="text-sm text-slate-300">${char.desc}</p>
                        <div class="bg-slate-900/50 p-2 rounded border border-slate-700/50">
                            <div class="flex items-center gap-2 text-amber-400 font-bold text-sm mb-1">
                                <i data-lucide="sparkles" class="w-3 h-3"></i> ${char.abilityName}
                            </div>
                            <p class="text-xs text-slate-400">${char.abilityDesc}</p>
                        </div>
                    </div>
                    <div class="flex gap-2 text-xs font-mono text-slate-500 mt-auto">
                        <span class="flex items-center gap-1"><i data-lucide="heart" class="w-3 h-3"></i> HP ${char.stats.hp}</span>
                    </div>
                </button>`;
            });

            html += `</div></div>`;
            return html;
        }

        function renderMap() {
            // Lines Logic
            let svgContent = '';
            for (let i = 0; i < GAME_DATA.zones.length - 1; i++) {
                const start = GAME_DATA.zones[i].mapPos;
                const end = GAME_DATA.zones[i+1].mapPos;
                const isUnlocked = player.completedZones.includes(GAME_DATA.zones[i].id);
                const stroke = isUnlocked ? "#f59e0b" : "#475569";
                const dash = isUnlocked ? "0" : "5,5";
                
                svgContent += `<line x1="${start.left}" y1="${start.top}" x2="${end.left}" y2="${end.top}" stroke="${stroke}" stroke-width="4" stroke-dasharray="${dash}" />`;
            }

            let html = `
            <div class="relative w-full h-full bg-[#1a202c] overflow-hidden flex flex-col">
                <!-- Top Player Bar -->
                <div class="bg-slate-900 border-b border-slate-700 p-2 flex justify-between items-center z-20 shadow-lg">
                    <div class="flex items-center gap-2">
                        <div class="bg-slate-800 p-1.5 rounded-full border border-slate-600">
                             <div class="font-bold text-xs ${player.role === 'Mage' ? 'text-purple-400' : 'text-red-400'} w-4 h-4 text-center">${player.name.substring(0,1)}</div>
                        </div>
                        <div class="flex flex-col">
                            <div class="text-xs text-slate-400 leading-none">${player.name}</div>
                            <div class="text-sm font-bold text-slate-200 leading-none">Lv.${player.level}</div>
                        </div>
                        <div class="w-20 h-2 bg-slate-800 rounded-full border border-slate-600 overflow-hidden ml-2">
                            <div class="bg-amber-500 h-full" style="width: ${(player.xp/player.maxXp)*100}%"></div>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        ${player.items.length > 0 ? `
                        <div class="flex gap-1 items-center bg-slate-800 px-3 py-1 rounded-full border border-slate-700 text-xs text-amber-200">
                            <i data-lucide="award" class="w-3 h-3"></i> <span>${player.items.length}</span>
                        </div>` : ''}
                    </div>
                </div>

                <!-- Interactive Map -->
                <div class="relative flex-1 bg-grid-pattern overflow-hidden">
                    <svg class="absolute inset-0 w-full h-full pointer-events-none z-0">${svgContent}</svg>`;

            // Nodes
            GAME_DATA.zones.forEach((zone, index) => {
                const isUnlocked = unlockZone(zone.id);
                const isCompleted = player.completedZones.includes(zone.id);
                const isNext = isUnlocked && !isCompleted;
                
                let iconHtml = '';
                if(isCompleted) iconHtml = '<i data-lucide="check-circle" class="w-8 h-8"></i>';
                else if(!isUnlocked) iconHtml = '<i data-lucide="lock" class="w-6 h-6"></i>';
                else iconHtml = `<i data-lucide="${zone.icon}" class="w-6 h-6"></i>`;

                let classes = "w-16 h-16 rounded-full flex items-center justify-center border-4 shadow-xl transition-all duration-300 cursor-pointer ";
                if (isCompleted) classes += "bg-amber-100 border-amber-500 text-amber-600 scale-100 ";
                else if (isNext) classes += "bg-amber-600 border-white text-white animate-pulse shadow-amber-500/50 ";
                else if (!isUnlocked) classes += "bg-slate-700 border-slate-600 text-slate-500 grayscale ";

                html += `
                <div onclick="showZonePopup('${zone.id}')" 
                     class="absolute transform -translate-x-1/2 -translate-y-1/2 z-10 flex flex-col items-center group"
                     style="top: ${zone.mapPos.top}; left: ${zone.mapPos.left};">
                    <div class="${classes} hover:scale-110">
                        ${iconHtml}
                    </div>
                    <div class="mt-2 px-3 py-1 rounded-full text-xs font-bold shadow-md ${isUnlocked ? 'bg-slate-800 text-amber-100 border border-amber-900/50' : 'bg-slate-800 text-slate-500 border border-slate-700'}">
                        ${zone.name}
                    </div>
                </div>`;
            });

            // Modal
            if (showZoneInfo) {
                const zoneIdx = GAME_DATA.zones.findIndex(z => z.id === showZoneInfo.id);
                const isCompleted = player.completedZones.includes(showZoneInfo.id);
                
                html += `
                <div class="absolute bottom-4 left-4 right-4 md:left-1/2 md:right-auto md:-translate-x-1/2 md:w-96 bg-slate-900/95 backdrop-blur border border-amber-500/30 p-6 rounded-2xl shadow-2xl z-50 animate-slide-up">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-slate-800 rounded-lg text-amber-500 border border-slate-700">
                                <i data-lucide="${showZoneInfo.icon}"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-white">${showZoneInfo.name}</h3>
                                <p class="text-xs text-amber-200/70">å»ºè­°ç­‰ç´š: Lv.${zoneIdx + 1}</p>
                            </div>
                        </div>
                        <button onclick="closeZonePopup()" class="text-slate-400 hover:text-white">âœ•</button>
                    </div>
                    <p class="text-sm text-slate-300 mb-6 leading-relaxed">${showZoneInfo.description}</p>
                    <div class="flex gap-3">
                        ${isCompleted ? 
                        `<div class="w-full py-3 bg-green-900/50 border border-green-700 text-green-400 rounded-lg text-center font-bold flex items-center justify-center gap-2">
                             <i data-lucide="check-circle" class="w-4 h-4"></i> å·²æ”»ç•¥å®Œæˆ
                         </div>` : 
                        `<button onclick="enterZone('${showZoneInfo.id}')" class="w-full py-3 bg-amber-600 hover:bg-amber-500 text-white border-b-4 border-amber-800 rounded-lg font-bold shadow-md active:scale-95">
                            é–‹å§‹æŒ‘æˆ°
                         </button>`
                        }
                    </div>
                </div>`;
            }

            html += `</div></div>`;
            return html;
        }

        function renderBattle() {
            if (!currentEnemy) return '';

            // Calc Percentage for Bars
            const enemyHpPct = (currentEnemy.currentHp / currentEnemy.hp) * 100;
            const playerHpPct = (player.hp / player.maxHp) * 100;

            let logHtml = battleLog.map(l => `<div class="mb-1 border-l-2 border-slate-600 pl-2">${l}</div>`).join('');

            return `
            <div class="max-w-3xl mx-auto p-4 flex flex-col h-full gap-4 w-full">
                <!-- Battle Header -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-slate-800 border-2 border-slate-600 rounded-xl p-4 shadow-xl flex flex-col items-center justify-center relative overflow-hidden">
                        <div class="absolute -right-4 -top-4 text-9xl opacity-5 select-none">ğŸ‘¾</div>
                        <div class="text-5xl mb-2 animate-bounce-custom z-10">ğŸ‘¾</div>
                        <h3 class="text-lg font-bold text-red-400 z-10">${currentEnemy.name}</h3>
                        <div class="w-full z-10 mt-2">
                            <div class="flex justify-between text-xs mb-1 text-slate-300 font-bold"><span>æ•µæ–¹ HP</span><span>${Math.ceil(currentEnemy.currentHp)}</span></div>
                            <div class="w-full bg-slate-900 rounded-full h-3 border border-slate-600"><div class="h-full rounded-full bg-red-600 transition-all duration-500" style="width: ${Math.max(0, enemyHpPct)}%"></div></div>
                        </div>
                    </div>
                    <div class="bg-slate-800 border-2 border-slate-600 rounded-xl p-4 shadow-xl flex flex-col items-center justify-center relative overflow-hidden">
                         <div class="absolute -left-4 -top-4 text-9xl opacity-5 select-none">ğŸ›¡ï¸</div>
                        <div class="text-5xl mb-2 z-10">${(player.characterId === 'kegui' || player.characterId === 'peiyu') ? 'ğŸ§™' : 'âš”ï¸'}</div>
                        <h3 class="text-lg font-bold text-blue-400 z-10">${player.name}</h3>
                        <div class="w-full z-10 mt-2">
                            <div class="flex justify-between text-xs mb-1 text-slate-300 font-bold"><span>æˆ‘æ–¹ HP</span><span>${player.hp}</span></div>
                            <div class="w-full bg-slate-900 rounded-full h-3 border border-slate-600"><div class="h-full rounded-full bg-green-500 transition-all duration-500" style="width: ${Math.max(0, playerHpPct)}%"></div></div>
                        </div>
                    </div>
                </div>

                <!-- Log -->
                <div id="battle-log-container" class="bg-black/40 p-3 rounded-lg h-24 overflow-y-auto text-sm text-slate-300 font-mono border border-slate-700/50 shadow-inner">
                    ${logHtml}
                </div>

                <!-- Question -->
                <div class="bg-slate-800 border-2 border-slate-600 rounded-xl p-4 shadow-xl flex-1 flex flex-col justify-center animate-slide-up border-amber-600/30">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <span class="inline-block px-3 py-1 bg-amber-900/50 border border-amber-700 text-amber-200 text-xs rounded-full flex items-center gap-1">
                                <i data-lucide="shuffle" class="w-3 h-3"></i> éš¨æ©Ÿé¡Œåº«
                            </span>
                            <span class="text-slate-400 text-xs">ç´¯è¨ˆç­”å°: ${player.solvedQuestionIds.length}</span>
                        </div>
                        <h2 class="text-xl md:text-2xl font-bold text-white leading-relaxed">${currentQuestion.q}</h2>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        ${currentQuestion.options.map((opt, idx) => `
                        <button onclick="handleAnswer(${idx})" class="group p-4 bg-slate-700 hover:bg-slate-600 border-l-4 border-slate-500 hover:border-amber-400 text-left text-slate-200 rounded-r-lg transition-all active:scale-95 flex items-center">
                            <span class="w-8 h-8 rounded-full bg-slate-800 text-amber-500 font-bold flex items-center justify-center mr-3 group-hover:bg-amber-500 group-hover:text-white transition-colors">
                                ${String.fromCharCode(65+idx)}
                            </span>
                            <span class="font-medium">${opt}</span>
                        </button>`).join('')}
                    </div>
                </div>
            </div>`;
        }

        function renderVictory() {
            return `
            <div class="flex flex-col items-center justify-center h-full text-center space-y-6 animate-fade-in p-6">
                <div class="bg-slate-800 p-8 rounded-2xl border-4 border-green-600 shadow-2xl max-w-md w-full relative overflow-hidden">
                    <div class="absolute inset-0 bg-grid-pattern opacity-20"></div>
                    <h1 class="text-4xl font-extrabold text-green-400 mb-4 z-10 relative">å€åŸŸæ”»ç•¥æˆåŠŸï¼</h1>
                    <div class="text-6xl mb-4 animate-bounce-custom z-10 relative">ğŸ†</div>
                    <p class="text-slate-300 mb-6 z-10 relative">ä½ æˆåŠŸé€šéäº† <span class="text-amber-400 font-bold">${currentZone.name}</span> çš„è€ƒé©—ï¼</p>
                    <div class="flex justify-center gap-4 mb-8 z-10 relative">
                        <div class="bg-slate-900 p-3 rounded-lg border border-slate-700">
                            <p class="text-xs text-slate-500 uppercase">XP ç²å¾—</p>
                            <p class="text-xl font-bold text-amber-400">å¤§é‡!</p>
                        </div>
                        <div class="bg-slate-900 p-3 rounded-lg border border-slate-700">
                            <p class="text-xs text-slate-500 uppercase">è§£é–</p>
                            <p class="text-xl font-bold text-blue-400">ä¸‹ä¸€å€åŸŸ</p>
                        </div>
                    </div>
                    <button onclick="returnToMap()" class="w-full py-3 bg-amber-600 hover:bg-amber-500 text-white border-b-4 border-amber-800 rounded-lg font-bold shadow-md active:scale-95 z-10 relative">è¿”å›åœ°åœ–</button>
                </div>
            </div>`;
        }

        function renderGameOver() {
            return `
            <div class="flex flex-col items-center justify-center h-full text-center space-y-6 animate-fade-in p-6">
                <div class="bg-slate-900 p-8 rounded-2xl border-4 border-red-800 shadow-2xl max-w-md w-full">
                    <h1 class="text-4xl font-extrabold text-red-600 mb-4">æ¢ç´¢å¤±æ•—...</h1>
                    <div class="text-6xl mb-4">â˜ ï¸</div>
                    <p class="text-slate-400 mb-6">ä½ çš„é«”åŠ›å·²è€—ç›¡ï¼Œç„¡æ³•ç¹¼çºŒæ¢ç´¢ã€‚</p>
                    <p class="text-slate-500 text-sm mb-8">åœ°è³ªçŸ¥è­˜å°±æ˜¯ä½ çš„åŠ›é‡ï¼Œä¸‹æ¬¡è«‹æº–å‚™æ›´å……è¶³å†ä¾†å§ï¼</p>
                    <button onclick="restartGame()" class="w-full py-3 bg-red-800 hover:bg-red-700 text-white border-b-4 border-red-900 rounded-lg font-bold shadow-md active:scale-95">é‡æ–°é–‹å§‹</button>
                </div>
            </div>`;
        }

        // --- INIT ---
        renderApp();

    </script>
</body>
</html>
